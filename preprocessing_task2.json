{"paragraphs":[{"text":"%spark.pyspark\nimport findspark\nimport pyspark\nfindspark.init(\"C:\\spark-2.4.4-bin-hadoop2.7\")\nfrom pyspark.sql import SparkSession,SQLContext\nfrom pyspark.sql.functions import *\nspark = SparkSession.builder.getOrCreate()\n\n\n#Importing Restaurant DataSet\nrestaurantDF = spark.read.format(\"csv\").option(\"header\",\"true\").load(\"restaurant_nyc.csv\")\n\n#Importing Crime DataSet\ncrimeDF = spark.read.format(\"csv\").option(\"header\",\"true\").load(\"NYPD_Complaint_Data_Historic.csv\").limit(30000)\n\n#Importing the Airbnb Listing DataSet (Combined 12 months to obtain unique values for Training)\nlistingDF = spark.read.option(\"header\", \"true\").csv(\"combinedData9Months.csv\")\nlistingDF = listingDF.withColumn(\"reviews_count\", col(\"number_of_reviews\").cast('int'))\nlistingDF = listingDF.withColumn(\"review_scores_rating\", col(\"review_scores_rating\").cast('int'))\n\n#Pre Processing to remove '$' from the Column price and convert it to integer type\nlistingDF = listingDF.withColumn(\"price\",translate (col(\"price\") , '$', ''))\nlistingDF = listingDF.withColumn(\"price\", col(\"price\").cast('int')).where(col(\"price\")!=lit(0))","user":"anonymous","dateUpdated":"2019-12-20T10:30:33-0500","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1575832730426_-55967419","id":"20191208-141850_896164554","dateCreated":"2019-12-08T14:18:50-0500","dateStarted":"2019-12-20T10:30:33-0500","dateFinished":"2019-12-20T10:30:34-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3240"},{"text":"%spark.pyspark\n\n#Selecting the relevant field from Airbnb dataset\nlistingDF = listingDF.select(\"id\",\"neighbourhood_cleansed\",\"neighbourhood_group_cleansed\",\"latitude\",\"longitude\",\"price\",\"number_of_reviews\",\"review_scores_rating\")\nlistingDF = listingDF.withColumn(\"latitude\", col(\"latitude\").cast('float')).withColumn(\"longitude\", col(\"longitude\").cast('float')).withColumnRenamed(\"longitude\",\"Longitude_listing\").withColumnRenamed(\"latitude\",\"Latitude_listing\")\nlistingDF.show()","user":"anonymous","dateUpdated":"2019-12-20T10:30:34-0500","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+----------------------+----------------------------+----------------+-----------------+-----+-----------------+--------------------+\n|  id|neighbourhood_cleansed|neighbourhood_group_cleansed|Latitude_listing|Longitude_listing|price|number_of_reviews|review_scores_rating|\n+----+----------------------+----------------------------+----------------+-----------------+-----+-----------------+--------------------+\n|2595|               Midtown|                   Manhattan|        40.75362|        -73.98377|  225|               48|                  94|\n|3831|          Clinton Hill|                    Brooklyn|        40.68514|        -73.95976|   89|              295|                  90|\n|5099|           Murray Hill|                   Manhattan|        40.74767|          -73.975|  200|               78|                  90|\n|5121|    Bedford-Stuyvesant|                    Brooklyn|        40.68688|        -73.95596|   60|               49|                  90|\n|5178|        Hell's Kitchen|                   Manhattan|        40.76489|        -73.98493|   79|              454|                  84|\n|5203|       Upper West Side|                   Manhattan|        40.80178|        -73.96723|   79|              118|                  98|\n|5238|             Chinatown|                   Manhattan|        40.71344|        -73.99037|  150|              161|                  94|\n|5441|        Hell's Kitchen|                   Manhattan|        40.76076|        -73.98867|   85|              204|                  97|\n|5803|           South Slope|                    Brooklyn|        40.66829|        -73.98779|   89|              175|                  94|\n|6090|          West Village|                   Manhattan|         40.7353|        -74.00525|  120|               27|                  97|\n|6848|          Williamsburg|                    Brooklyn|        40.70837|        -73.95352|  140|              170|                  91|\n|7097|           Fort Greene|                    Brooklyn|        40.69169|        -73.97185|  199|              215|                  97|\n|7322|               Chelsea|                   Manhattan|        40.74192|        -73.99501|  120|              296|                  96|\n|7726|         Crown Heights|                    Brooklyn|        40.67592|        -73.94694|   99|               75|                  95|\n|7750|           East Harlem|                   Manhattan|        40.79685|        -73.94872|  190|                0|                null|\n|7801|          Williamsburg|                    Brooklyn|        40.71842|        -73.95718|  299|                9|                  98|\n|8024|            Park Slope|                    Brooklyn|        40.68069|        -73.97706|  115|              143|                  93|\n|8025|            Park Slope|                    Brooklyn|        40.67989|        -73.97798|   80|               41|                  91|\n|8110|            Park Slope|                    Brooklyn|        40.68001|        -73.97865|   32|               77|                  92|\n|8490|    Bedford-Stuyvesant|                    Brooklyn|        40.68371|        -73.94028|  120|              105|                  95|\n+----+----------------------+----------------------------+----------------+-----------------+-----+-----------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1575832773444_145695131","id":"20191208-141933_872115089","dateCreated":"2019-12-08T14:19:33-0500","dateStarted":"2019-12-20T10:30:34-0500","dateFinished":"2019-12-20T10:30:35-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3241"},{"text":"%spark.pyspark\n\n#Selecting the relevant field from Crime dataset\ncrimeDF = crimeDF.select(\"CMPLNT_NUM\",\"Latitude\",\"Longitude\",\"BORO_NM\").where(col(\"Latitude\") != \"NONE\").where(col(\"Longitude\") != \"NONE\")\ncrimeDF = crimeDF.withColumn(\"Latitude\", col(\"Latitude\").cast('float')).withColumn(\"Longitude\", col(\"Longitude\").cast('float')).withColumnRenamed(\"Longitude\",\"Longitude_crime\").withColumnRenamed(\"Latitude\",\"Latitude_crime\")\ncrimeDF.show()","user":"anonymous","dateUpdated":"2019-12-20T10:30:35-0500","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+--------------+---------------+---------+\n|CMPLNT_NUM|Latitude_crime|Longitude_crime|  BORO_NM|\n+----------+--------------+---------------+---------+\n| 876525802|     40.669415|     -73.912605| BROOKLYN|\n| 402693528|      40.80198|      -73.94551|MANHATTAN|\n| 832030069|      40.69999|      -73.83098|   QUEENS|\n| 538308771|     40.681004|      -73.95503| BROOKLYN|\n| 141085517|     40.678337|     -73.925575| BROOKLYN|\n| 484433797|      40.86847|      -73.82159|    BRONX|\n| 106486628|     40.669865|      -73.92545| BROOKLYN|\n| 330148303|     40.878754|      -73.87254|    BRONX|\n| 772315573|     40.696194|      -73.75197|   QUEENS|\n| 415191250|       40.6754|      -73.88112| BROOKLYN|\n| 306568702|     40.795082|     -73.939186|MANHATTAN|\n| 781664524|     40.747246|      -73.99336|MANHATTAN|\n| 774511569|      40.75596|      -73.99073|MANHATTAN|\n| 458693223|     40.853817|      -73.85528|    BRONX|\n| 684762539|     40.832325|       -73.9316|    BRONX|\n| 631504051|     40.841694|      -73.91111|    BRONX|\n| 637964791|      40.82237|     -73.950615|MANHATTAN|\n| 730205151|     40.860878|     -73.895905|    BRONX|\n| 816337536|     40.827415|     -73.877945|    BRONX|\n| 367892768|     40.722054|       -73.9532| BROOKLYN|\n+----------+--------------+---------------+---------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1575832825007_-1523199930","id":"20191208-142025_1047421460","dateCreated":"2019-12-08T14:20:25-0500","dateStarted":"2019-12-20T10:30:35-0500","dateFinished":"2019-12-20T10:30:43-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3242"},{"text":"%spark.pyspark\n\n#Joining the Crime Data and Airbnb data using inner join on NYC Borough (eg. Manhattan, Brooklyn)\ncombinedDF = crimeDF.join(listingDF,lower(crimeDF.BORO_NM)==lower(listingDF.neighbourhood_group_cleansed))\n\n#For each of the listing, counting the number of criminal activities recorded withing 0.5 kms.\ncombinedDF = combinedDF.where(sqrt(((col(\"Latitude_crime\")-col(\"Latitude_listing\"))*60)**2+((col(\"Longitude_crime\")-col(\"Longitude_listing\"))*60)**2)<=0.25)","user":"anonymous","dateUpdated":"2019-12-20T10:30:43-0500","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1575839545270_-1595020906","id":"20191208-161225_60330193","dateCreated":"2019-12-08T16:12:25-0500","dateStarted":"2019-12-20T10:30:43-0500","dateFinished":"2019-12-20T10:30:43-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3243"},{"text":"%spark.pyspark\n\ncombinedDF = combinedDF.groupBy(\"id\").count().withColumnRenamed(\"id\",\"id_1\")\n\ncombinedDF.show()","user":"anonymous","dateUpdated":"2019-12-20T10:30:43-0500","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-----+\n|   id_1|count|\n+-------+-----+\n|  16974|  125|\n|  55498|   32|\n| 193105|   21|\n| 233638|   41|\n| 237127|  104|\n| 258688|   65|\n| 271083|   38|\n| 466277|   34|\n| 578941|   13|\n| 622410|   49|\n| 644575|   12|\n| 882209|   35|\n|1022204|   99|\n|1266411|   42|\n|1535236|   39|\n|1740311|   95|\n|1823141|   77|\n|1887489|   38|\n|1939485|   87|\n|1959024|   58|\n+-------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1575840553374_1362096212","id":"20191208-162913_692706940","dateCreated":"2019-12-08T16:29:13-0500","dateStarted":"2019-12-20T10:30:43-0500","dateFinished":"2019-12-20T10:31:00-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3244"},{"text":"%spark.pyspark\n\ncombinedDF = combinedDF.join(listingDF,combinedDF.id_1 == listingDF.id).drop(col(\"id_1\")).withColumnRenamed(\"count\",\"count_crime\")\ncombinedDF.show()","user":"anonymous","dateUpdated":"2019-12-20T10:31:00-0500","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+-------+----------------------+----------------------------+----------------+-----------------+-----+-----------------+--------------------+\n|count_crime|     id|neighbourhood_cleansed|neighbourhood_group_cleansed|Latitude_listing|Longitude_listing|price|number_of_reviews|review_scores_rating|\n+-----------+-------+----------------------+----------------------------+----------------+-----------------+-----+-----------------+--------------------+\n|        125|  16974|           East Harlem|                   Manhattan|        40.80164|        -73.93922|  225|              206|                  96|\n|         32|  55498|    Bedford-Stuyvesant|                    Brooklyn|         40.6829|        -73.93549|   71|               37|                  99|\n|         21| 193105|        Hell's Kitchen|                   Manhattan|         40.7709|        -73.99181|  139|               45|                  96|\n|         41| 233638|             Ridgewood|                      Queens|        40.70163|        -73.90867|   55|               19|                  94|\n|        104| 237127|              Kips Bay|                   Manhattan|        40.73833|        -73.98186|   99|              139|                  87|\n|         65| 258688|          West Village|                   Manhattan|        40.74031|        -74.00532|  325|               46|                  95|\n|         38| 271083|  Prospect-Lefferts...|                    Brooklyn|        40.65772|        -73.96131|   89|              129|                  90|\n|         34| 466277|          Williamsburg|                    Brooklyn|         40.7111|        -73.94643|  235|              125|                  97|\n|         13| 578941|            Park Slope|                    Brooklyn|        40.66732|        -73.98233|  159|                4|                  95|\n|         49| 622410|         Crown Heights|                    Brooklyn|        40.66839|        -73.96001|   85|                0|                null|\n|         12| 644575|         Tompkinsville|               Staten Island|        40.63358|         -74.0833|   71|               24|                  96|\n|         35| 882209|          Williamsburg|                    Brooklyn|        40.70502|        -73.95262|   90|               39|                  93|\n|         99|1022204|       Lower East Side|                   Manhattan|        40.72198|        -73.98932|  110|               49|                  98|\n|         42|1266411|    Bedford-Stuyvesant|                    Brooklyn|        40.68445|        -73.93785|  181|              165|                  95|\n|         39|1535236|    Bedford-Stuyvesant|                    Brooklyn|        40.68711|        -73.95346|  105|                4|                  87|\n|         95|1740311|       Lower East Side|                   Manhattan|        40.72105|        -73.98519|  300|               72|                  93|\n|         77|1823141|       Lower East Side|                   Manhattan|        40.72018|        -73.98839|   92|                0|                null|\n|         38|1887489|  Prospect-Lefferts...|                    Brooklyn|        40.66173|        -73.95382|  175|                0|                null|\n|         87|1939485|          West Village|                   Manhattan|        40.72931|        -74.00321|  225|                3|                 100|\n|         58|1959024|       Upper East Side|                   Manhattan|        40.77924|        -73.95405|  499|                6|                 100|\n+-----------+-------+----------------------+----------------------------+----------------+-----------------+-----+-----------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1575844203741_273054931","id":"20191208-173003_401715527","dateCreated":"2019-12-08T17:30:03-0500","dateStarted":"2019-12-20T10:31:00-0500","dateFinished":"2019-12-20T10:31:16-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3245"},{"text":"%spark.pyspark\n\n#pre-processing and data cleaning on the Restaurant/facilities dataset\n\nrestaurantDF = restaurantDF.select(\"CAMIS\",\"BORO\",\"Latitude\",\"Longitude\").where(col(\"Latitude\") != \"NONE\").where(col(\"Longitude\") != \"NONE\")\nrestaurantDF = restaurantDF.withColumn(\"Latitude\", col(\"Latitude\").cast('float')).withColumn(\"Longitude\", col(\"Longitude\").cast('float')).withColumnRenamed(\"Longitude\",\"Longitude_rest\").withColumnRenamed(\"Latitude\",\"Latitude_rest\")\nrestaurantDF.show()","user":"anonymous","dateUpdated":"2019-12-20T10:31:16-0500","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+---------+-------------+--------------+\n|   CAMIS|     BORO|Latitude_rest|Longitude_rest|\n+--------+---------+-------------+--------------+\n|50078597|Manhattan|     40.77837|     -73.94829|\n|40364179|Manhattan|    40.801373|     -73.96016|\n|50069376|   Queens|     40.75847|     -73.82961|\n|50061519| Brooklyn|    40.678616|     -73.97898|\n|41109700|   Queens|    40.736694|     -73.86566|\n|50057858| Brooklyn|    40.707428|     -73.95504|\n|50002396| Brooklyn|    40.673416|     -73.95696|\n|50000582|Manhattan|     40.72706|    -73.979774|\n|40397305| Brooklyn|    40.691387|     -73.95127|\n|50006240|Manhattan|     40.72282|     -74.00472|\n|41329496| Brooklyn|     40.60888|     -73.97243|\n|41477916|Manhattan|    40.760384|     -73.96997|\n|50054573|Manhattan|    40.709824|       -74.012|\n|40692961| Brooklyn|    40.637756|     -73.89672|\n|50063311|   Queens|     40.76033|     -73.82987|\n|50071617|   Queens|    40.707367|     -73.79609|\n|40535467|Manhattan|    40.719574|     -73.99628|\n|50059759|   Queens|     40.70747|     -73.78858|\n|40401887|   Queens|    40.660686|     -73.73905|\n|50089917| Brooklyn|     40.67194|      -73.9169|\n+--------+---------+-------------+--------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1575845075590_224773395","id":"20191208-174435_1858647915","dateCreated":"2019-12-08T17:44:35-0500","dateStarted":"2019-12-20T10:31:16-0500","dateFinished":"2019-12-20T10:31:17-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3246"},{"text":"%spark.pyspark\n\n# Similar to the steps done above, counting the number of restaurant/facilities available within a 0.5 km radius of each listing\n\ncombinedWithRestaurantDF = restaurantDF.join(combinedDF,lower(restaurantDF.BORO)==lower(combinedDF.neighbourhood_group_cleansed))\ncombinedWithRestaurantDF = combinedWithRestaurantDF.where(sqrt(((col(\"Latitude_rest\")-col(\"Latitude_listing\"))*60)**2+((col(\"Longitude_rest\")-col(\"Longitude_listing\"))*60)**2)<=0.25)\n","user":"anonymous","dateUpdated":"2019-12-20T10:31:17-0500","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1575845944628_2112066605","id":"20191208-175904_560517861","dateCreated":"2019-12-08T17:59:04-0500","dateStarted":"2019-12-20T10:31:17-0500","dateFinished":"2019-12-20T10:31:17-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3247"},{"text":"%spark.pyspark\ncombinedWithRestaurantDF.show()\n","user":"anonymous","dateUpdated":"2019-12-20T10:31:17-0500","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+-----+-------------+--------------+-----------+--------+----------------------+----------------------------+----------------+-----------------+-----+-----------------+--------------------+\n|   CAMIS| BORO|Latitude_rest|Longitude_rest|count_crime|      id|neighbourhood_cleansed|neighbourhood_group_cleansed|Latitude_listing|Longitude_listing|price|number_of_reviews|review_scores_rating|\n+--------+-----+-------------+--------------+-----------+--------+----------------------+----------------------------+----------------+-----------------+-----+-----------------+--------------------+\n|50045738|Bronx|    40.870445|     -73.84618|         21|35237543|              Allerton|                       Bronx|        40.86871|         -73.8474|   40|                1|                 100|\n|50045738|Bronx|    40.870445|     -73.84618|         15|21897845|        Pelham Gardens|                       Bronx|        40.86706|        -73.84674|   40|               17|                  97|\n|50045738|Bronx|    40.870445|     -73.84618|         23|11020169|            Baychester|                       Bronx|        40.87223|        -73.84335|   95|              223|                  96|\n|50045738|Bronx|    40.870445|     -73.84618|         20|30109916|              Allerton|                       Bronx|        40.86975|        -73.84669|   75|                7|                 100|\n|50045738|Bronx|    40.870445|     -73.84618|         22|34941479|              Allerton|                       Bronx|        40.86997|        -73.84867|   36|                2|                 100|\n|50045738|Bronx|    40.870445|     -73.84618|         21|18685854|            Baychester|                       Bronx|        40.87192|        -73.84676|   60|                0|                null|\n|50045738|Bronx|    40.870445|     -73.84618|         20|34941506|              Allerton|                       Bronx|         40.8688|        -73.84726|  120|                2|                  70|\n|50045738|Bronx|    40.870445|     -73.84618|         22|18852919|              Allerton|                       Bronx|        40.87063|        -73.84896|   70|                3|                  80|\n|50045738|Bronx|    40.870445|     -73.84618|         22|34941499|              Allerton|                       Bronx|        40.86958|        -73.84872|   38|                2|                 100|\n|50045738|Bronx|    40.870445|     -73.84618|         22| 5046189|              Allerton|                       Bronx|        40.87054|        -73.84681|  750|               45|                  96|\n|50045738|Bronx|    40.870445|     -73.84618|         25|35996222|              Allerton|                       Bronx|        40.86886|        -73.84915|  140|               29|                  97|\n|50045738|Bronx|    40.870445|     -73.84618|         17|17076735|        Pelham Gardens|                       Bronx|        40.86673|          -73.845|  129|               90|                  98|\n|50059864|Bronx|      40.8193|     -73.92697|         45|13530166|             Concourse|                       Bronx|        40.82162|        -73.92698|   50|                0|                null|\n|50059864|Bronx|      40.8193|     -73.92697|         49| 3627326|             Concourse|                       Bronx|        40.81954|        -73.92715|  115|                4|                  65|\n|50059864|Bronx|      40.8193|     -73.92697|         40|17981267|             Concourse|                       Bronx|        40.82097|        -73.92739|  145|               89|                  93|\n|50059864|Bronx|      40.8193|     -73.92697|         37| 1026683|             Concourse|                       Bronx|        40.81906|        -73.92806|   85|               13|                  98|\n|50059864|Bronx|      40.8193|     -73.92697|         36|29167257|             Concourse|                       Bronx|        40.82132|        -73.92884|  100|               39|                  94|\n|50059864|Bronx|      40.8193|     -73.92697|         44|19655186|             Concourse|                       Bronx|        40.82153|        -73.92683|  140|                2|                  90|\n|50059864|Bronx|      40.8193|     -73.92697|         35| 9788114|             Concourse|                       Bronx|        40.82023|        -73.92844|   87|              164|                  96|\n|50059864|Bronx|      40.8193|     -73.92697|         40|28462811|             Concourse|                       Bronx|        40.82228|        -73.92783|   45|               56|                  93|\n+--------+-----+-------------+--------------+-----------+--------+----------------------+----------------------------+----------------+-----------------+-----+-----------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1575847583591_-933669773","id":"20191208-182623_652472398","dateCreated":"2019-12-08T18:26:23-0500","dateStarted":"2019-12-20T10:31:17-0500","dateFinished":"2019-12-20T10:31:41-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3248"},{"text":"%spark.pyspark\n\n#Combining both the above results generated to get the count of Crimes and restaurant against each Airbnb Listing\ncombinedWithRestaurantDF = combinedWithRestaurantDF.groupBy(\"id\").count().withColumnRenamed(\"id\",\"id_1\")","user":"anonymous","dateUpdated":"2019-12-20T10:31:41-0500","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1575846840539_1594390512","id":"20191208-181400_191229173","dateCreated":"2019-12-08T18:14:00-0500","dateStarted":"2019-12-20T10:31:41-0500","dateFinished":"2019-12-20T10:31:41-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3249"},{"text":"%spark.pyspark\ncombinedWithRestaurantDF = combinedWithRestaurantDF.join(combinedDF,combinedWithRestaurantDF.id_1 == combinedDF.id).drop(col(\"id_1\")).withColumnRenamed(\"count\",\"count_restaurant\")\ncombinedWithRestaurantDF.show()\n","user":"anonymous","dateUpdated":"2019-12-20T10:31:41-0500","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------+-----------+--------+----------------------+----------------------------+----------------+-----------------+-----+-----------------+--------------------+\n|count_restaurant|count_crime|      id|neighbourhood_cleansed|neighbourhood_group_cleansed|Latitude_listing|Longitude_listing|price|number_of_reviews|review_scores_rating|\n+----------------+-----------+--------+----------------------+----------------------------+----------------+-----------------+-----+-----------------+--------------------+\n|             987|         37|10034090|          Williamsburg|                    Brooklyn|        40.71049|        -73.94515|   40|                1|                 100|\n|            4375|         99| 1022204|       Lower East Side|                   Manhattan|        40.72198|        -73.98932|  110|               49|                  98|\n|             686|         24|10234090|           Sunset Park|                    Brooklyn|         40.6642|        -73.99371|  105|                1|                  80|\n|            3341|         81|10500222|          West Village|                   Manhattan|        40.73492|        -74.00457|  196|                2|                 100|\n|             155|         10|10537769|            Greenpoint|                    Brooklyn|        40.72963|        -73.94937|   45|                0|                null|\n|            3164|        106|10692885|               Chelsea|                   Manhattan|        40.74237|        -74.00063|  120|                2|                 100|\n|             599|         12|10708986|          Williamsburg|                    Brooklyn|        40.71766|        -73.94367|  120|               27|                  97|\n|             194|         35|10974609|         East Flatbush|                    Brooklyn|        40.66209|        -73.93947|   42|                1|                null|\n|             529|         21|11483117|          Clinton Hill|                    Brooklyn|        40.69483|        -73.96403|   54|               30|                  95|\n|             825|         97|11788559|                Harlem|                   Manhattan|         40.8014|        -73.95469|  450|                9|                  93|\n|             362|         35|11890343|              Bushwick|                    Brooklyn|        40.69332|        -73.91216|    5|               92|                  86|\n|             623|         67|11903561|          East Village|                   Manhattan|        40.72093|        -73.97964|  100|                0|                null|\n|             310|         39|11948586|              Flatbush|                    Brooklyn|        40.63836|        -73.95698|   85|                6|                  73|\n|             306|         69|12211018|    Bedford-Stuyvesant|                    Brooklyn|         40.6886|        -73.94153|   79|                0|                null|\n|             868|        108|12626663|                Harlem|                   Manhattan|        40.80854|        -73.94305|  125|                1|                 100|\n|             684|         54|12643924|  Prospect-Lefferts...|                    Brooklyn|        40.65447|        -73.96122|   41|               44|                  93|\n|             416|         42| 1266411|    Bedford-Stuyvesant|                    Brooklyn|        40.68445|        -73.93785|  181|              165|                  95|\n|             941|         61|12864095|           Boerum Hill|                    Brooklyn|        40.68558|        -73.98065|   65|                0|                null|\n|            4973|        132|12989766|      Theater District|                   Manhattan|        40.76004|        -73.98552|   99|               80|                  83|\n|             110|         63|13081205|    Bedford-Stuyvesant|                    Brooklyn|        40.69676|        -73.94773|   60|                0|                null|\n+----------------+-----------+--------+----------------------+----------------------------+----------------+-----------------+-----+-----------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1575846505542_-87793797","id":"20191208-180825_202595994","dateCreated":"2019-12-08T18:08:25-0500","dateStarted":"2019-12-20T10:31:41-0500","dateFinished":"2019-12-20T10:35:12-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3250"},{"text":"%spark.pyspark\n\n#Saving the result generated as a csv for Training our Machine Learning Model\ncombinedWithRestaurantDF.toPandas().to_csv('mycsv.csv')\ncombinedWithRestaurantDF.printSchema()","user":"anonymous","dateUpdated":"2019-12-20T10:35:12-0500","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- count_restaurant: long (nullable = false)\n |-- count_crime: long (nullable = false)\n |-- id: string (nullable = true)\n |-- neighbourhood_cleansed: string (nullable = true)\n |-- neighbourhood_group_cleansed: string (nullable = true)\n |-- Latitude_listing: float (nullable = true)\n |-- Longitude_listing: float (nullable = true)\n |-- price: integer (nullable = true)\n |-- number_of_reviews: string (nullable = true)\n |-- review_scores_rating: integer (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1575848575938_-784569583","id":"20191208-184255_1677322499","dateCreated":"2019-12-08T18:42:55-0500","dateStarted":"2019-12-20T10:35:12-0500","dateFinished":"2019-12-20T10:38:52-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3251"},{"text":"%spark.pyspark\n\n","user":"anonymous","dateUpdated":"2019-12-10T17:42:07-0500","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1575859581624_-91625765","id":"20191208-214621_1595863691","dateCreated":"2019-12-08T21:46:21-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3252"}],"name":"Project_Start","id":"2ETU2PN7R","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}